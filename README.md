<img width="1080" height="540" alt="image" src="https://github.com/user-attachments/assets/73bf52e1-0325-4a1f-b473-2dde45a82f28" />

# программый Дядя Айро - система для рекомендации чая

## Идея
Данны проект выполнялся в рамках курса 'управление IT проектом' на 1 семестре магистратуры 'Прикладной математики' МАИ.
Идея проекта обучить несколько моделей, которые будут выдавать какие-нибудь характеристики людей - раса, местоположение, возраст, настроение и тд, и на основании
этих характеристик выдавать чай из базы данных. По итогу остановился на двух моделях CV для определения возраста и настроения. Вот так примерно будет выглядеть архитектура:
<img width="523" height="811" alt="image" src="https://github.com/user-attachments/assets/3ab26fb1-9b6c-4c91-a42e-ada4c6c26bb8" />

## Модель CV для определения настроения
Так как набор данных для определения настроения был достаточно большим, скомпилируем свою сверточную нейронную сеть.
В сверточной части расположим 5 сверточных блоков, а в классификационной части поместим 3 полносвязных слоя и получим следующую архитектуру модели:

<img width="974" height="794" alt="image" src="https://github.com/user-attachments/assets/242b32d5-15ab-42e0-98d5-bb1b6b1ffe90" />

Обучение проходило по 30 эпохах два этапа c learning rate = 0.0001.

<img width="620" height="509" alt="image" src="https://github.com/user-attachments/assets/ac86c152-04c5-42fe-ad94-2d6d5fcfecd4" />

Сеть обучилась достаточно хорошо, и удалось достичь качества метрики accuracy в 0.84.

## Модель CV для определения возраста
Со следующей моделью были некоторые нюансы. Первый из них заключается в том, что данных не так-то много и для достижения хороших результатов придется воспользоваться transfer learning. Второй нюанс – из-за структуры данных будет проще реализовать решение задачи не регрессии, что было бы логично, а задачи классификации, как мы и поступим. На качество решения этот ход не повлияет, так как возраст и так ограничен от 0 до 100. 
Как уже было сказано будем пользоваться преобученной сетью – resnet50. Перенесем ее в первый блок, разморозив последней слой, для большой адаптации к задаче. В последнем слое, как и в прошлой задаче, расположим три полносвязных слоя для классификации. Итого имеем следующую архитектуру:

<img width="930" height="678" alt="image" src="https://github.com/user-attachments/assets/c5a5f784-59dd-4af1-af16-d47609dd580e" />

Ну и так же обучим с оптимизатором Adam и низким learning rate. Все этапы обучения представлены ниже.

<img width="974" height="397" alt="image" src="https://github.com/user-attachments/assets/cbd0da34-c922-4a12-9f4a-d69e65b3d481" />
<img width="974" height="402" alt="image" src="https://github.com/user-attachments/assets/decfdab5-4a91-44ec-b116-ec35d8796dd2" />

В итоге удалось достичь результата в 0.94 accuracy. Подход с предобученной моделью себя идеально оправдал, и модель хорошо обучилась на маленьком датасете.

## Создание датасета и функции для рекомендации чая

Создадим сначала простой датасет для проверки

<img width="974" height="559" alt="image" src="https://github.com/user-attachments/assets/8e3c3e5e-496d-4ab9-a94d-4053fae1f671" />

Также добавим ограничения внутри функции - если возраст будет слишком мал, будет предложена альтернатива.
Функция для подбора готова, осталось загрузить модели и провести полноценный тест. Для построения моделей использовался PyTorch, поэтому для загрузки моделей необходимо воссоздать их архитектуру и дополнить ее весами с сохраненной модели.
Теперь проверим работу функции и моделей.

<img width="790" height="691" alt="image" src="https://github.com/user-attachments/assets/c40591ec-b109-4acc-811d-eda891c1e37d" />
<img width="858" height="583" alt="image" src="https://github.com/user-attachments/assets/e7a59265-736a-4d8b-8846-ac941534af14" />

При проверке можно заметить некоторые проблемы работы моделей - определение возраста и настроения для людей СНГ происходят немного странно, хотя это можно объяснить выборкой, в выборке люди только из Европы и Америки. Но, в общем и целом проект работает!

## Возможные улучшение
Система пока статична в своих знаниях о предпочтениях. Интересным развитием было бы научить ее запоминать выбор пользователя и со временем корректировать рекомендации, создавая персонализированный вкусовой профиль.
Можно добавить анализ внешних контекстов — времени суток, сезона, погоды за окном. Технически было бы полезно дообучать модели на более разнообразных данных, особенно для эмоционального анализа, добавив больше культурных и индивидуальных особенностей в выражении чувств.
Практическим шагом могло бы стать создание простого интерфейса обратной связи — например, кнопки "понравилось/не понравилось", чтобы алгоритм со временем становился точнее именно для конкретного человека.

## Итог

Этот проект — не просто техническая демонстрация возможностей нейронных сетей, а целостное решение, которое соединяет технологии компьютерного зрения с глубоким пониманием предметной области.
Он превращает выбор чая из рутинного действия в осознанный ритуал, где учитывается и физическое состояние человека, и его эмоциональный настрой.
Система демонстрирует, как машинное обучение может применяться не только для решения глобальных задач, но и для улучшения повседневных моментов жизни, добавляя в них элементы персональной заботы и внимания к деталям.
Это пример того, как технологии могут стать не заметнее, а, наоборот, — более человечными, помогая нам делать выбор, который действительно соответствует нашему состоянию здесь и сейчас.
